define("block_evasys_sync/evaluation_request",["exports","core/templates","core/prefetch","core/str"],(function(_exports,_templates,_prefetch,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Dynamically edits the evaluation_request mform.
   *
   * @module     block_evasys_sync/evaluation_request
   * @copyright  2022 Justus Dieckmann WWU
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=async function(){const select=document.getElementById("id_lsfcourses"),evaltimes=document.getElementById("fitem_id_evaltimes"),dateselectortemplate=document.getElementById("evasys-dateselectortemplate").innerHTML;_prefetch.default.prefetchTemplate("block_evasys_sync/form");const strings=await Promise.all([(0,_str.get_string)("startondate","block_evasys_sync"),(0,_str.get_string)("endondate","block_evasys_sync")]),startdateselectortemplate=dateselectortemplate.replaceAll("MyEvasysElementLabel",strings[0]),enddateselectortemplate=dateselectortemplate.replaceAll("MyEvasysElementLabel",strings[1]);select.onchange=async()=>{for(const lsfcourse of evaltimes.children){const id=lsfcourse.getAttribute("data-evasys-lsfid");savedDates[id]={start:getSelectorTime("id_evaltimestart_"+id),end:getSelectorTime("id_evaltimeend_"+id)}}let html="";evaltimes.disabled=!0;for(const option of select.selectedOptions)html+=await _templates.default.render("block_evasys_sync/form",{html:startdateselectortemplate.replaceAll("myevasyselementname","evaltimestart_"+option.value)+enddateselectortemplate.replaceAll("myevasyselementname","evaltimeend_"+option.value),lsfid:option.value,coursename:option.text});evaltimes.innerHTML=html;for(const option of select.selectedOptions)option.value in savedDates?(setSelectorTime("id_evaltimestart_"+option.value,savedDates[option.value].start),setSelectorTime("id_evaltimeend_"+option.value,savedDates[option.value].end)):(setSelectorTime("id_evaltimestart_"+option.value,new Date),setSelectorTime("id_evaltimeend_"+option.value,new Date));evaltimes.disabled=!1}},_templates=_interopRequireDefault(_templates),_prefetch=_interopRequireDefault(_prefetch);const savedDates={};function getSelectorTime(id){const d=new Date;return d.setFullYear(document.getElementById(id+"_year").value,document.getElementById(id+"_month").value-1,document.getElementById(id+"_day").value),d.setHours(document.getElementById(id+"_hour").value,document.getElementById(id+"_minute").value),d}function setSelectorTime(id,date){document.getElementById(id+"_year").value=date.getFullYear(),document.getElementById(id+"_month").value=date.getMonth()+1,document.getElementById(id+"_day").value=date.getDate(),document.getElementById(id+"_hour").value=date.getHours(),document.getElementById(id+"_minute").value=date.getMinutes()}}));

//# sourceMappingURL=evaluation_request.min.js.map