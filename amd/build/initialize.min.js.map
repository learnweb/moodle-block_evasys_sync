{"version":3,"file":"initialize.min.js","sources":["../src/initialize.js"],"sourcesContent":["define(['jquery', 'core/notification', 'core/str'], function ($, notification, str) {\n    var init = function(starttime, endtime, mode) {\n        var start = new Date(starttime * 1000);\n        var end = new Date(endtime * 1000);\n        var endenabled;\n        if ($('[name=minute_start]').length == 0) {\n            // No form present.\n            return;\n        }\n        $('[name=minute_start]').last()[0].selectedIndex = start.getMinutes();\n        $('[name=hour_start]').last()[0].selectedIndex = start.getHours();\n        $('[name=day_start]').last()[0].selectedIndex = start.getDate() - 1;\n        $('[name=month_start]').last()[0].selectedIndex = start.getMonth();\n        $('[name=year_start]').last()[0].selectedIndex = start.getFullYear() - 2000;\n\n        $('[name=minute_end]').last()[0].selectedIndex = end.getMinutes();\n        $('[name=hour_end]').last()[0].selectedIndex = end.getHours();\n        $('[name=day_end]').last()[0].selectedIndex = end.getDate() - 1;\n        $('[name=month_end]').last()[0].selectedIndex = end.getMonth();\n        $('[name=year_end]').last()[0].selectedIndex = end.getFullYear() - 2000;\n        if ($('#reactivate').length > 0) {\n            endenabled = !$('[name=minute_end]')[0].disabled;\n            $(document).on(\"change\", \"#reactivate\", function() {\n                if (this.checked) {\n                    // Ask for confirmation, then enable all fields related to re-invitation.\n                    str.get_strings([\n                        {'key': 'confirm'},\n                        {'key': 'content_confirm_reactivate_'+mode, component: 'block_evasys_sync'},\n                        {'key': 'yes'},\n                        {'key': 'no'},\n                        {'key': 'requestagain', component: 'block_evasys_sync'}\n                    ]).done(function(s) {\n                        notification.confirm(s[0], s[1], s[2], s[3],\n                            function () {\n                                // User pressed yes.\n                                $('[name=minute_start]')[0].disabled = false;\n                                $('[name=hour_start]')[0].disabled = false;\n                                $('[name=day_start]')[0].disabled = false;\n                                $('[name=month_start]')[0].disabled = false;\n                                $('[name=year_start]')[0].disabled = false;\n                                if (!endenabled) {\n                                    $('[name=minute_end]')[0].disabled = false;\n                                    $('[name=hour_end]')[0].disabled = false;\n                                    $('[name=day_end]')[0].disabled = false;\n                                    $('[name=month_end]')[0].disabled = false;\n                                    $('[name=year_end]')[0].disabled = false;\n                                }\n                                if ($('#direct_invite').length > 0) {\n                                    $('#direct_invite').prop('disabled', false);\n                                }\n                                if ($('#only_end').length > 0) {\n                                    $('#only_end').prop(\"value\", false);\n                                }\n                                if ($('#evasyssubmitbutton').length > 0) {\n                                    $('#evasyssubmitbutton').prop(\"disabled\", false);\n                                    $('#evasyssubmitbutton').val(s[4]);\n                                }\n                            },\n                            function () {\n                                // User pressed no.\n                                $('#reactivate').prop(\"checked\", false);\n                            });\n                    });\n                } else {\n                    // Disable all fields related to re-invitation.\n                    $('[name=minute_start]')[0].disabled = true;\n                    $('[name=hour_start]')[0].disabled = true;\n                    $('[name=day_start]')[0].disabled = true;\n                    $('[name=month_start]')[0].disabled = true;\n                    $('[name=year_start]')[0].disabled = true;\n                    if (!endenabled) {\n                        $('[name=minute_end]')[0].disabled = true;\n                        $('[name=hour_end]')[0].disabled = true;\n                        $('[name=day_end]')[0].disabled = true;\n                        $('[name=month_end]')[0].disabled = true;\n                        $('[name=year_end]')[0].disabled = true;\n                    }\n                    if ($('#direct_invite').length > 0) {\n                        $('#direct_invite').prop('disabled', true);\n                    }\n                    if ($('#only_end').length > 0) {\n                        $('#only_end').prop(\"value\", true);\n                    }\n                    if ($('#evasyssubmitbutton').length > 0) {\n                        if (!endenabled) {\n                            $('#evasyssubmitbutton').prop(\"disabled\", true);\n                        }\n                        str.get_strings([\n                            {'key': 'planorstartevaluation', component: 'block_evasys_sync'},\n                            {'key': 'invitestudents', component: 'block_evasys_sync'}\n                        ]).done(function(s) {\n                            if ($('#direct_invite').length > 0) {\n                                // User can start invitation herself.\n                                $('#evasyssubmitbutton').val(s[0]);\n                            } else {\n                                // User can only request evaluation from the coordinator.\n                                $('#evasyssubmitbutton').val(s[1]);\n                            }\n                        });\n                    }\n                }\n            });\n        }\n        if ($('#direct_invite').length > 0) {\n            $(document).on(\"change\", \"#direct_invite\", function () {\n                if (this.checked) {\n                    // Disable startdate as evaluation will start immediately.\n                    $('[name=minute_start]')[0].disabled = true;\n                    $('[name=hour_start]')[0].disabled = true;\n                    $('[name=day_start]')[0].disabled = true;\n                    $('[name=month_start]')[0].disabled = true;\n                    $('[name=year_start]')[0].disabled = true;\n                } else {\n                    // Allow user to set startdate.\n                    $('[name=minute_start]')[0].disabled = false;\n                    $('[name=hour_start]')[0].disabled = false;\n                    $('[name=day_start]')[0].disabled = false;\n                    $('[name=month_start]')[0].disabled = false;\n                    $('[name=year_start]')[0].disabled = false;\n\n                }\n            });\n        }\n    };\n\n    return {\n        init: init\n    };\n});"],"names":["define","$","notification","str","init","starttime","endtime","mode","endenabled","start","Date","end","length","last","selectedIndex","getMinutes","getHours","getDate","getMonth","getFullYear","disabled","document","on","this","checked","get_strings","component","done","s","confirm","prop","val"],"mappings":"AAAAA,sCAAO,CAAC,SAAU,oBAAqB,aAAa,SAAUC,EAAGC,aAAcC,WA6HpE,CACHC,KA7HO,SAASC,UAAWC,QAASC,UAGhCC,WAFAC,MAAQ,IAAIC,KAAiB,IAAZL,WACjBM,IAAM,IAAID,KAAe,IAAVJ,SAEoB,GAAnCL,EAAE,uBAAuBW,SAI7BX,EAAE,uBAAuBY,OAAO,GAAGC,cAAgBL,MAAMM,aACzDd,EAAE,qBAAqBY,OAAO,GAAGC,cAAgBL,MAAMO,WACvDf,EAAE,oBAAoBY,OAAO,GAAGC,cAAgBL,MAAMQ,UAAY,EAClEhB,EAAE,sBAAsBY,OAAO,GAAGC,cAAgBL,MAAMS,WACxDjB,EAAE,qBAAqBY,OAAO,GAAGC,cAAgBL,MAAMU,cAAgB,IAEvElB,EAAE,qBAAqBY,OAAO,GAAGC,cAAgBH,IAAII,aACrDd,EAAE,mBAAmBY,OAAO,GAAGC,cAAgBH,IAAIK,WACnDf,EAAE,kBAAkBY,OAAO,GAAGC,cAAgBH,IAAIM,UAAY,EAC9DhB,EAAE,oBAAoBY,OAAO,GAAGC,cAAgBH,IAAIO,WACpDjB,EAAE,mBAAmBY,OAAO,GAAGC,cAAgBH,IAAIQ,cAAgB,IAC/DlB,EAAE,eAAeW,OAAS,IAC1BJ,YAAcP,EAAE,qBAAqB,GAAGmB,SACxCnB,EAAEoB,UAAUC,GAAG,SAAU,eAAe,WAChCC,KAAKC,QAELrB,IAAIsB,YAAY,CACZ,KAAQ,WACR,KAAQ,8BAA8BlB,KAAMmB,UAAW,qBACvD,KAAQ,OACR,KAAQ,MACR,KAAQ,eAAgBA,UAAW,uBACpCC,MAAK,SAASC,GACb1B,aAAa2B,QAAQD,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IACrC,WAEI3B,EAAE,uBAAuB,GAAGmB,UAAW,EACvCnB,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,sBAAsB,GAAGmB,UAAW,EACtCnB,EAAE,qBAAqB,GAAGmB,UAAW,EAChCZ,aACDP,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,mBAAmB,GAAGmB,UAAW,EACnCnB,EAAE,kBAAkB,GAAGmB,UAAW,EAClCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,mBAAmB,GAAGmB,UAAW,GAEnCnB,EAAE,kBAAkBW,OAAS,GAC7BX,EAAE,kBAAkB6B,KAAK,YAAY,GAErC7B,EAAE,aAAaW,OAAS,GACxBX,EAAE,aAAa6B,KAAK,SAAS,GAE7B7B,EAAE,uBAAuBW,OAAS,IAClCX,EAAE,uBAAuB6B,KAAK,YAAY,GAC1C7B,EAAE,uBAAuB8B,IAAIH,EAAE,QAGvC,WAEI3B,EAAE,eAAe6B,KAAK,WAAW,UAK7C7B,EAAE,uBAAuB,GAAGmB,UAAW,EACvCnB,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,sBAAsB,GAAGmB,UAAW,EACtCnB,EAAE,qBAAqB,GAAGmB,UAAW,EAChCZ,aACDP,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,mBAAmB,GAAGmB,UAAW,EACnCnB,EAAE,kBAAkB,GAAGmB,UAAW,EAClCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,mBAAmB,GAAGmB,UAAW,GAEnCnB,EAAE,kBAAkBW,OAAS,GAC7BX,EAAE,kBAAkB6B,KAAK,YAAY,GAErC7B,EAAE,aAAaW,OAAS,GACxBX,EAAE,aAAa6B,KAAK,SAAS,GAE7B7B,EAAE,uBAAuBW,OAAS,IAC7BJ,YACDP,EAAE,uBAAuB6B,KAAK,YAAY,GAE9C3B,IAAIsB,YAAY,CACZ,KAAQ,wBAAyBC,UAAW,qBAC5C,KAAQ,iBAAkBA,UAAW,uBACtCC,MAAK,SAASC,GACT3B,EAAE,kBAAkBW,OAAS,EAE7BX,EAAE,uBAAuB8B,IAAIH,EAAE,IAG/B3B,EAAE,uBAAuB8B,IAAIH,EAAE,aAOnD3B,EAAE,kBAAkBW,OAAS,GAC7BX,EAAEoB,UAAUC,GAAG,SAAU,kBAAkB,WACnCC,KAAKC,SAELvB,EAAE,uBAAuB,GAAGmB,UAAW,EACvCnB,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,sBAAsB,GAAGmB,UAAW,EACtCnB,EAAE,qBAAqB,GAAGmB,UAAW,IAGrCnB,EAAE,uBAAuB,GAAGmB,UAAW,EACvCnB,EAAE,qBAAqB,GAAGmB,UAAW,EACrCnB,EAAE,oBAAoB,GAAGmB,UAAW,EACpCnB,EAAE,sBAAsB,GAAGmB,UAAW,EACtCnB,EAAE,qBAAqB,GAAGmB,UAAW"}