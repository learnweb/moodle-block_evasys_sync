define ("block_evasys_sync/edit_timeframe",["jquery","core/modal_factory","core/templates","core/str","core/url"],function(a,b,c,d,e){var f=function(){var b=a("[name=minute_start]").last()[0].selectedIndex,c=a("[name=hour_start]").last()[0].selectedIndex,d=a("[name=day_start]").last()[0].selectedIndex,e=a("[name=month_start]").last()[0].selectedIndex,f=a("[name=year_start]").last()[0].selectedIndex+2e3,g=a("[name=minute_end]").last()[0].selectedIndex,h=a("[name=hour_end]").last()[0].selectedIndex,i=a("[name=day_end]").last()[0].selectedIndex,j=a("[name=month_end]").last()[0].selectedIndex,k=a("[name=year_end]").last()[0].selectedIndex+2e3,l=new Date(f,e,d+1,c,b),m=new Date(k,j,i+1,h,g);return{starttime:l.getTime()/1e3,endtime:m.getTime()/1e3}},g=function(){if(4===this.readyState&&200<=this.status&&!(""==this.responseText)){require(["core/notification"],function(a){d.get_string("save_failure","block_evasys_sync").done(function(b){a.alert("Error",b,"OK")})})}};return{initialize:function initialize(h,j){var k=0;d.get_string("edit_time","block_evasys_sync").done(function(i){var l=!0;while(l){var m=a("#timeediturl_"+k);if(0>=m.length){l=!1;break}m.on("click",function(k){var l=a(k.currentTarget);b.create({type:b.types.SAVE_CANCEL,title:i,body:c.render("block_evasys_sync/edittime",{})}).then(function(b){var c=b.getRoot();c.on("modal-save-cancel:save",function(){var b=new URL(l.prop("href")).searchParams.get("id"),c={},i=a("[name=use_standardtime]").last()[0].checked;if(i){c=f()}c.category=b;var k=new XMLHttpRequest;k.onreadystatechange=g;var m=e.relativeUrl("/blocks/evasys_sync/alterstandardtime.php",c,!0);k.open("GET",m);k.send();var n=l.prop("id").split("_")[1];h[n]=c.starttime;j[n]=c.endtime;if(i){d.get_string("time_set","block_evasys_sync").done(function(a){document.getElementById("timehint_"+n).innerHTML=a})}else{document.getElementById("timehint_"+n).innerHTML=""}});b.show();require(["block_evasys_sync/initialize"],function(b){var c=l.prop("id").split("_")[1];if(null===h[c]||h[c]===void 0){h[c]=Date.now()/1e3;j[c]=Date.now()/1e3}else{a("[name=use_standardtime]").last()[0].checked=!0}b.init(h[c],j[c])})})});k++}})}}});
//# sourceMappingURL=edit_timeframe.min.js.map
